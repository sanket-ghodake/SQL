# [1633.  Percentage of Users Attended a Contest](https://leetcode.com/problems/percentage-of-users-attended-a-contest/)

Write a solution to find the percentage of the users registered in each contest rounded to  **two decimals**.

Return the result table ordered by  `percentage`  in  **descending order**. In case of a tie, order it by  `contest_id`  in  **ascending order**.

The result format is in the following example.

**Example 1:**

**Input:** 
Users table:

| user_id | user_name |
|-|-|
| 6       | Alice     |
| 2       | Bob       |
| 7       | Alex      |

Register table:

| contest_id | user_id |
|-|-|
| 215        | 6       |
| 209        | 2       |
| 208        | 2       |
| 210        | 6       |
| 208        | 6       |
| 209        | 7       |
| 209        | 6       |
| 215        | 7       |
| 208        | 7       |
| 210        | 2       |
| 207        | 2       |
| 210        | 7       |

**Output:** 

| contest_id | percentage |
|-|-|
| 208        | 100.0      |
| 209        | 100.0      |
| 210        | 100.0      |
| 215        | 66.67      |
| 207        | 33.33      |

**Explanation:** 

All the users registered in contests 208, 209, and 210. The percentage is 100% and we sort them in the answer table by contest_id in ascending order.

Alice and Alex registered in contest 215 and the percentage is ((2/3) * 100) = 66.67%

Bob registered in contest 207 and the percentage is ((1/3) * 100) = 33.33%

## Join and Count - [3888ms](https://leetcode.com/problems/percentage-of-users-attended-a-contest/submissions/1038190045/?source=submission-ac)

```sql
/*
-- count total number of users
select count(*) from Users
*/

select r.contest_id, round(count(r.user_id)*100/ (select count(*) from Users),2) as percentage 
-- register users Register table / total users in User Table
from Users u,Register r -- first joining two tables 
where  u.user_id = r.user_id
group by r.contest_id
order by percentage desc, r.contest_id
```

## Optimized Version of above solution using 1=1 - [2080ms](https://leetcode.com/problems/percentage-of-users-attended-a-contest/submissions/1038437340/?source=submission-ac)

```sql
-- count total number of users
-- select count(*) from Users


select r.contest_id, round(count(r.user_id)*100/ (select count(*) from Users),2) as percentage
from Users u
inner join Register r
on 1=1
and u.user_id = r.user_id
group by r.contest_id
order by percentage desc, r.contest_id
```

## Linking every user with unique Contest Id - [2244ms](https://leetcode.com/problems/percentage-of-users-attended-a-contest/submissions/1038435362/?source=submission-ac)

```sql
select r.contest_id, round
					(
  						count(r1.user_id) * 100/count(u.user_id)
                      	,
                      	2
                    ) as percentage
from Users u
inner join (select distinct contest_id from Register) r -- link every user to every unique contest id
on 1=1
left join Register r1
-- left joining above table with Register table, so there will be track who user is not Register for contest as separate row
on 1=1 
and r1.contest_id = r.contest_id 
and r1.user_id = u.user_id
group by r.contest_id
order by percentage desc ,r.contest_id
;
```

## Simplest using group by without join - Beats 80% - [1692ms](https://leetcode.com/problems/percentage-of-users-attended-a-contest/submissions/1038446828/?source=submission-ac)

```sql
/*
-- count total number of users
select count(*) from Users
*/

select r.contest_id, round(count(r.user_id)*100/ (select count(*) from Users),2) as percentage
from Register r
group by r.contest_id
order by percentage desc, r.contest_id
```


## Note - While joining multiple tables 

```sql
-- Both syntax are correct, table order while join doesn't matters
-- First 
select *
from  Users u ,(select distinct contest_id from Register) r
inner join Register r1
on r1.user_id = u.user_id

-- Second
select *
from  (select distinct contest_id from Register) r, Users u
inner join Register r1
on r1.user_id = u.user_id
```


